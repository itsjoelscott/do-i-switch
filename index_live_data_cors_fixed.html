<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Should I Switch?</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Should I Switch? A side-by-side breakdown of iPhone vs Android features with search and filtering.">
  <meta name="robots" content="index,follow">
  <style>
    :root {
      --max-width: 1200px;
      --sidebar-width: 300px;
      --gap: 16px;
      font-family: system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
    }
    body { margin:0; padding:0; background:#f2f4f7; }
    .container {
      display:flex;
      max-width: var(--max-width);
      margin:0 auto;
      padding:24px;
      gap: var(--gap);
    }
    .main {
      flex:1;
      background:#fff;
      padding:24px;
      border-radius:12px;
      box-shadow:0 4px 20px rgba(0,0,0,0.08);
      overflow-x:auto;
    }
    h1 { margin-top:0; font-size:2.5rem; font-weight:700; text-align:center; }
    h2 { margin-top:4px; font-size:1.1rem; color:#555; font-weight:400; text-align:center; }
    .controls {
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      margin:16px 0;
      justify-content:center;
      align-items:center;
    }
    .controls label { font-size:0.9rem; }
    .controls input, .controls select {
      padding:8px 10px;
      border:1px solid #ccc;
      border-radius:6px;
      font-size:1rem;
      min-width:200px;
    }
    table {
      width:100%;
      border-collapse:collapse;
      margin-top:8px;
    }
    th, td {
      padding:12px 8px;
      border-bottom:1px solid #e1e4ea;
      vertical-align:top;
    }
    th {
      background:#f7f9fc;
      text-align:left;
      font-weight:600;
      position:sticky;
      top:0;
      z-index:1;
    }
    .center { text-align:center; }
    .sidebar {
      width: var(--sidebar-width);
      position:sticky;
      top:24px;
      align-self:start;
      background:#fff;
      padding:16px;
      border-radius:12px;
      box-shadow:0 4px 20px rgba(0,0,0,0.08);
      font-size:14px;
    }
    .ad-box {
      background:#e8eaf0;
      border:2px dashed #cfd8e8;
      padding:16px;
      margin-bottom:24px;
      border-radius:8px;
      min-height:180px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      color:#333;
    }
    .mobile-ads { display:none; }
    @media (max-width:1000px){
      .mobile-ads { display:block; margin-bottom:16px; }
      .container { flex-direction:column; }
      .sidebar { display:none; }
      .mobile-ads .ad-box:nth-child(2){display:none;}
    }
    .footer { text-align:center; font-size:12px; margin-top:40px; color:#888; }
    .clear-btn { margin-left:8px; cursor:pointer; background:#0070f3; color:#fff; border:none; padding:8px 12px; border-radius:6px; }
    /* Suggestion modal */
    #suggestion-modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:999; align-items:center; justify-content:center; }
    #suggestion-modal .dialog { background:#fff; border-radius:12px; max-width:500px; width:100%; padding:24px; position:relative; box-shadow:0 20px 60px rgba(0,0,0,0.2); }
    #suggestion-modal button.close { position:absolute; top:12px; right:12px; background:none; border:none; font-size:18px; cursor:pointer; }
    #suggest-btn { position:fixed; bottom:24px; right:24px; background:#ffb400; border:none; padding:14px 18px; border-radius:50px; box-shadow:0 10px 30px rgba(0,0,0,0.2); cursor:pointer; font-weight:600; z-index:900; }
  </style>
  <!-- Google Analytics placeholder: replace MEASUREMENT_ID with your GA4 ID -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  

<script>
async function loadLiveData() {
  const baseCsvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ-qCmwBdzTbjoydKlYuCpfwydZTO2Rz4htuYXBIndXF1tAqjxaKuzAOk8ktoAGn2sB8mLw-mt8p8Fj/pub?output=csv';
  const csvUrl = baseCsvUrl + '&_=' + Date.now();
  try {
    const resp = await fetch(csvUrl, { mode: 'cors' });
    if (!resp.ok) {
      throw new Error('HTTP error ' + resp.status + ' ' + resp.statusText);
    }
    const text = await resp.text();
    const rows = text
      .trim()
      .split('\n')
      .map(r => r.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g)?.map(c => c.replace(/^"|"$/g, '').trim()) || []);
    const table = document.querySelector('table[aria-label="Comparison table"]');
    if (!table) {
      console.warn('Comparison table not found in DOM.');
      return;
    }
    const thead = table.tHead || table.createTHead();
    const tbody = table.tBodies[0] || table.createTBody();
    tbody.innerHTML = '';
    if (rows.length === 0) {
      throw new Error('CSV is empty or could not be parsed.');
    }
    const headerRow = rows[0];
    const header = thead.rows[0] || thead.insertRow();
    header.innerHTML = '';
    headerRow.forEach(h => {
      const th = document.createElement('th');
      th.textContent = h;
      header.appendChild(th);
    });
    rows.slice(1).forEach(r => {
      if (r.every(cell => cell === '')) return;
      const tr = tbody.insertRow();
      r.forEach(cell => {
        const td = tr.insertCell();
        td.textContent = cell;
      });
    });
    console.log('Live data loaded successfully. Rows:', rows.length - 1);
  } catch (e) {
    console.error('Failed to load live data:', e);
    const existing = document.getElementById('live-data-error');
    if (existing) existing.remove();
    const msg = document.createElement('div');
    msg.id = 'live-data-error';
    msg.textContent = 'Failed to load live data. Error: ' + (e.message || 'unknown');
    msg.style.color = 'white';
    msg.style.background = 'crimson';
    msg.style.padding = '10px';
    msg.style.margin = '10px';
    msg.style.fontWeight = '600';
    document.body.prepend(msg);
  }
}
document.addEventListener('DOMContentLoaded', loadLiveData);
</script>

<script>
async function loadLiveData() {
  const baseCsvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ-qCmwBdzTbjoydKlYuCpfwydZTO2Rz4htuYXBIndXF1tAqjxaKuzAOk8ktoAGn2sB8mLw-mt8p8Fj/pub?gid=0&single=true&output=csv';
  const csvUrl = baseCsvUrl + '&_=' + Date.now(); // cache buster
  try {
    const resp = await fetch(csvUrl, { mode: 'cors' });
    if (!resp.ok) {
      throw new Error('HTTP error ' + resp.status + ' ' + resp.statusText);
    }
    const text = await resp.text();
    const rows = text
      .trim()
      .split('\n')
      .map(r => r.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g)?.map(c => c.replace(/^"|"$/g, '').trim()) || []);
    const table = document.querySelector('table[aria-label="Comparison table"]');
    if (!table) {
      console.warn('Comparison table not found in DOM.');
      return;
    }
    const thead = table.tHead || table.createTHead();
    const tbody = table.tBodies[0] || table.createTBody();
    tbody.innerHTML = '';
    if (rows.length === 0) {
      throw new Error('CSV is empty or could not be parsed.');
    }
    const headerRow = rows[0];
    const header = thead.rows[0] || thead.insertRow();
    header.innerHTML = '';
    headerRow.forEach(h => {
      const th = document.createElement('th');
      th.textContent = h;
      header.appendChild(th);
    });
    rows.slice(1).forEach(r => {
      if (r.every(cell => cell === '')) return;
      const tr = tbody.insertRow();
      r.forEach(cell => {
        const td = tr.insertCell();
        td.textContent = cell;
      });
    });
    console.log('Live data loaded successfully. Rows:', rows.length - 1);
  } catch (e) {
    console.error('Failed to load live data:', e);
    const existing = document.getElementById('live-data-error');
    if (existing) existing.remove();
    const msg = document.createElement('div');
    msg.id = 'live-data-error';
    msg.textContent = 'Failed to load live data. Error: ' + (e.message || 'unknown');
    msg.style.color = 'white';
    msg.style.background = 'crimson';
    msg.style.padding = '10px';
    msg.style.margin = '10px';
    msg.style.fontWeight = '600';
    document.body.prepend(msg);
  }
}
document.addEventListener('DOMContentLoaded', loadLiveData);
</script>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script>
function showError(msg){
  const existing = document.getElementById('live-data-error');
  if (existing) existing.remove();
  const div = document.createElement('div');
  div.id='live-data-error';
  div.textContent = 'Failed to load live data. ' + msg;
  div.style.color='white';
  div.style.background='crimson';
  div.style.padding='10px';
  div.style.margin='10px';
  div.style.fontWeight='600';
  document.body.prepend(div);
}
function populateTable(dataTable){
  const table = document.querySelector('table[aria-label="Comparison table"]');
  if (!table) {
    console.warn('Comparison table not found.');
    return;
  }
  const thead = table.tHead || table.createTHead();
  const tbody = table.tBodies[0] || table.createTBody();
  thead.innerHTML = '';
  tbody.innerHTML = '';
  // Header
  const headerRow = thead.insertRow();
  for (let c=0;c<dataTable.getNumberOfColumns();c++){
    const th = document.createElement('th');
    th.textContent = dataTable.getColumnLabel(c);
    headerRow.appendChild(th);
  }
  // Body
  for (let r=0;r<dataTable.getNumberOfRows();r++){
    const tr = tbody.insertRow();
    for (let c=0;c<dataTable.getNumberOfColumns();c++){
      const td = tr.insertCell();
      const val = dataTable.getValue(r,c);
      td.textContent = (val !== null && val !== undefined) ? val : '';
    }
  }
}
function loadLiveData(){
  // Load visualization API
  google.charts.load('current', {'packages':['corechart','table']});
  google.charts.setOnLoadCallback(function(){
    const query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/e/2PACX-1vQ-qCmwBdzTbjoydKlYuCpfwydZTO2Rz4htuYXBIndXF1tAqjxaKuzAOk8ktoAGn2sB8mLw-mt8p8Fj/gviz/tq?gid=0');
    query.send(function(response){
      if (response.isError()){
        showError(response.getMessage());
        console.error('GViz error', response.getMessage(), response.getDetailedMessage());
        return;
      }
      const data = response.getDataTable();
      populateTable(data);
      console.log('Live data loaded via Visualization API. Rows:', data.getNumberOfRows());
    });
  });
}
document.addEventListener('DOMContentLoaded', loadLiveData);
</script>
